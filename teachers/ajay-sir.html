<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>AJAY SIR [AKM] Profile</title>
      <script src="https://cdn.tailwindcss.com"></script>
      <link rel="stylesheet" href="/style.css">
      <link rel="icon" type="image/jpeg" href="/pictures/neelaxmi.png">
      <meta name="google-site-verification" content="iatylsdA3ilcUEyKshZLLZmpDIh6TMUdj7qjgoLTWxw" />
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="/css.teachers.css">
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

      
   </head>
   
      <style>
         :root {
         --color-bg-page: #f9f9f9;
         --color-bg-card: #ffffff;
         --color-text-primary: #1f2937;
         --color-text-secondary: #6b7280;
         --color-accent: #2563eb; /* Blue Follow Button */
         --color-accent-text: #ffffff;
         --color-border: #e5e7eb;
         --color-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
         --sidebar-width: min(280px, 85vw);
         --primary-gradient: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
         --glass-bg: rgba(255, 255, 255, 0.05);
         --glass-border: rgba(255, 255, 255, 0.1);
         --text-dim: #94a3b8;
        --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

         /* Dark Mode */
         body[data-theme='dark'] {
         --color-bg-page: #111827;
         --color-bg-card: #1f2937;
         --color-text-primary: #f3f4f6;
         --color-text-secondary: #9ca3af;
         --color-accent: #4f46e5;
         --color-accent-text: #ffffff;
         --color-border: #374151;
         --color-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -4px rgba(0, 0, 0, 0.3);
         }
         /* Vibrant UI */
         body[data-theme='vibrant'] {
         --color-bg-page: #f0fdf4;
         --color-bg-card: #ffffff;
         --color-text-primary: #16a34a; /* Green Text */
         --color-text-secondary: #65a30d;
         --color-accent: #10b981; 
         --color-accent-text: #ffffff;
         --color-border: #d1fae5;
         --color-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.2), 0 2px 4px -2px rgba(16, 185, 129, 0.1);
         }
         /* Minimalist Theme */
         body[data-theme='minimalist'] {
         --color-bg-page: #ffffff;
         --color-bg-card: #ffffff;
         --color-text-primary: #000000;
         --color-text-secondary: #374151;
         --color-accent: #000000;
         --color-accent-text: #ffffff;
         --color-border: #d1d5db;
         --color-shadow: none;
         }
         /* Unacademy-Inspired Theme */
         body[data-theme='unacademy-inspired'] {
         --color-bg-page: #ffffff;
         --color-bg-card: #ffffff;
         --color-text-primary: #212121;
         --color-text-secondary: #9aa1a7;
         --color-accent: #374151; /* Dark Gray Follow Button */
         --color-accent-text: #ffffff;
         --color-border: #e9e9e9;
         --color-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05), 0 1px 2px 0 rgba(0, 0, 0, 0.03);
         }
         /* Apply CSS variables */
         body {
         font-family: 'Inter', sans-serif;
         transition: background-color 0.3s, color 0.3s;
         background-color: var(--color-bg-page);
         }
         .card {
         background-color: var(--color-bg-card);
         color: var(--color-text-primary);
         box-shadow: var(--color-shadow);
         border: 1px solid var(--color-border);
         transition: all 0.3s ease-in-out;
         }
         .card:hover {
         transform: translateY(-4px); 
         box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
         }
         .text-primary { color: var(--color-text-primary); }
         .text-secondary { color: var(--color-text-secondary); }
         .bg-accent { background-color: var(--color-accent); }
         .text-accent { color: var(--color-accent); }
         .text-accent-text { color: var(--color-accent-text); }
         .border-accent { border-color: var(--color-accent); }
         .border-border { border-color: var(--color-border); }
         /* Custom Tab Styles */
         .tab {
         color: var(--color-text-secondary);
         transition: color 0.2s;
         }
         .tab:hover {
         color: var(--color-text-primary);
         }
         .tab-active {
         color: var(--color-text-primary);
         font-weight: 600;
         border-bottom: 2px solid var(--color-accent);
         }
         /* Filter Button Styles */
         .filter-btn {
         padding: 6px 14px;
         border-radius: 9999px; /* full rounded */
         font-size: 0.875rem; /* text-sm */
         font-weight: 500;
         transition: all 0.2s;
         cursor: pointer;
         border: 1px solid var(--color-border);
         background-color: var(--color-bg-card);
         color: var(--color-text-secondary);
         }
         .filter-btn:hover {
         background-color: var(--color-bg-page);
         color: var(--color-text-primary);
         }
         .filter-btn.active {
         background-color: var(--color-accent);
         color: var(--color-accent-text);
         border-color: var(--color-accent);
         box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
         }
         /* Theme Button Styles */
         .theme-btn {
         display: flex;
         align-items: center;
         padding: 8px 16px;
         border-radius: 6px;
         font-size: 14px;
         font-weight: 500;
         transition: all 0.2s ease;
         cursor: pointer;
         border: 1px solid var(--color-border);
         background-color: var(--color-bg-card);
         color: var(--color-text-primary);
         }
         .theme-btn:hover {
         background-color: var(--color-bg-page);
         }
         .theme-btn.active {
         background-color: var(--color-accent);
         color: var(--color-accent-text);
         border-color: var(--color-accent);
         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
         }
         .theme-btn.active .theme-icon {
         fill: var(--color-accent-text);
         }
         /* Styling for the list/text content view */
         .content-list-item {
         background-color: var(--color-bg-card);
         border: 1px solid var(--color-border);
         transition: background-color 0.2s, border-color 0.2s;
         }
         .content-list-item:hover {
         border-color: var(--color-accent);
         }
         /* --- Theme-Aware Animated Border Enhancements (VFX) --- */
         @keyframes glow {
         0% { box-shadow: 0 0 0 0px currentColor; opacity: 1; } 
         70% { box-shadow: 0 0 0 10px currentColor; opacity: 0; }
         100% { box-shadow: 0 0 0 0px currentColor; opacity: 0; }
         }
         .glowing-border {
         border: 3px solid white; 
         color: var(--color-accent); 
         animation: glow 2s infinite cubic-bezier(0.4, 0, 0.6, 1);
         }
         .logo-vfx {
         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 0 0 8px rgba(255, 255, 255, 0.5);
         }
         .card .absolute.bottom-4.left-4 {
         z-index: 10; 
         }
         /* Feature Block Styling */
         .content-feature-block:hover .arrow-icon {
         transform: translateX(4px); 
         }
         .content-feature-block .arrow-icon {
         transition: transform 0.2s ease-out;
         }
         .content-feature-block {
         text-decoration: none;
         display: block; 
         transition: all 0.3s ease-in-out;
         }
         /* NEW STYLES FOR MODULE GRID */
         .module-card {
         position: relative;
         overflow: hidden;
         }
         .module-card::before {
         content: '';
         position: absolute;
         top: 0; left: 0; right: 0; bottom: 0;
         background: linear-gradient(135deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.1) 100%);
         pointer-events: none;
         }
         
        .cyber-grid {
         display: grid;
         grid-template-columns: repeat(12, 1fr);
         gap: 1.5rem;
         }

.cyber-card {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-radius: 1.5rem;
    padding: 1.5rem;
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    overflow: hidden;
    position: relative;
}

body[data-theme='dark'] .cyber-card {
    background: rgba(30, 41, 59, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.cyber-card:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.2);
    border-color: var(--color-accent);
}

.cyber-card::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transition: 0.5s;
    pointer-events: none;
}

.cyber-card:hover::before {
    left: 100%;
}

.text-gradient {
    background: linear-gradient(135deg, #2563eb, #9333ea);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 800;
}

.neon-badge {
    box-shadow: 0 0 10px var(--color-accent);
    animation: pulse-glow 2s infinite;
}

@keyframes pulse-glow {
    0% { box-shadow: 0 0 5px var(--color-accent); }
    50% { box-shadow: 0 0 15px var(--color-accent), 0 0 5px var(--color-accent); }
    100% { box-shadow: 0 0 5px var(--color-accent); }
}

.col-span-12 { grid-column: span 12; }
.col-span-8 { grid-column: span 12; }
.col-span-4 { grid-column: span 12; }

@media (min-width: 768px) {
    .col-span-8 { grid-column: span 8; }
    .col-span-4 { grid-column: span 4; }
    .col-span-6 { grid-column: span 6; }
}

/* PDF Viewer Styles */
#pdf-viewer-container {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.9);
    z-index: 9999;
    flex-direction: column;
}
#pdf-frame {
    width: 100%;
    height: 100%;
    border: none;
}
.close-pdf {
    position: absolute;
    top: 20px;
    right: 30px;
    color: white;
    font-size: 30px;
    cursor: pointer;
    z-index: 10000;
}


.j-star-bg {
    background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
    color: white;
}


</style>
   
   
   <button class="menu-toggle" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
    </button>

<nav class="sidebar" id="sidebar">
    <a href="/index.html" class="nav-link active"><i class="fas fa-home"></i> Home</a>
            <a href="/quiz/DASHBOARD.HTML" class="nav-link"><i class="fas fa-brain"></i> DASHBOARD</a>

    
    <a href="https://akmsirdiscussion.netlify.app/" target="_blank" class="nav-link"><i class="fas fa-comments"></i> AKM SIR DISCUSSION</a>
    <a href="https://neetcountdown2026.netlify.app/" target="_blank" class="nav-link"><i class="fas fa-clock"></i> NEET COUNTDOWN</a>
    <a href="https://saksenquiz.netlify.app/" target="_blank" class="nav-link"><i class="fas fa-lightbulb"></i> SAKSEN QUIZ CORNER</a>
    <a href="https://dppanalysis.netlify.app/" target="_blank" class="nav-link"><i class="fas fa-chart-bar"></i> DPP ANALYSIS</a>
    <a href="#" target="_blank" class="nav-link"><i class="fas fa-calendar-check"></i> SCHEDULE TRACKER</a>
    <a href="http://diwalisak.netlify.app/" target="_blank" class="nav-link"><i class="fas fa-firework"></i> DIWALI VFX</a>
    
    <a href="https://telegram.me/saksen_main_bot" target="_blank" class="nav-link"><i class="fab fa-telegram"></i> MAIN BOT</a>

    <div style="margin-top: auto; padding: 20px; font-size: 0.75rem; color: #64748b;">
        ¬© <span id="year"></span> TEAM SAKSEN
    </div>
</nav>

   <body data-theme="default-ui">
      <div class="max-w-6xl mx-auto px-4 md:px-8 pt-4">
         

           
         <div id="theme-switcher" class="flex flex-wrap gap-2 p-2 card rounded-xl shadow-lg border-none">
         </div>
         
      </div>
      
      <div class="max-w-6xl mx-auto p-4 md:p-8">
         <header class="flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-8 pb-6 border-b border-border">
            <div class="flex items-center space-x-4">
               <div class="w-24 h-24 sm:w-32 sm:h-32 rounded-full overflow-hidden border-2 border-border flex-shrink-0">
                  <img src="/pictures/akmsir.jpg" onerror="this.src='https://placehold.co/128x128/000/fff?text=AKM'" alt="AJAY SIR [AKM]" class="w-full h-full object-cover">
               </div>
               <h1 class="text-3xl font-extrabold text-primary">AJAY SIR [AKM]</h1>
            </div>
            <div class="flex flex-col md:flex-row md:ml-auto items-start md:items-center space-y-4 md:space-y-0 md:space-x-8">
               <div class="flex space-x-6 text-center">
                  <div class="text-primary">
                     <div class="text-xl font-bold" id="watchMinsDisplay">...</div>
                     <div class="text-xs text-secondary">WATCH MINS</div>
                  </div>
                  <div class="text-primary">
                     <div class="text-xl font-bold flex items-center justify-center">
                        <span id="dedicationsDisplay">...</span>
                        <span class="ml-1 text-yellow-500">
                           <svg class="w-5 h-5 fill-current" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                           </svg>
                        </span>
                     </div>
                     <div class="text-xs text-secondary">DEDICATIONS</div>
                  </div>
                  <div class="text-primary">
                     <div class="text-xl font-bold" id="followersDisplay">...</div>
                     <div class="text-xs text-secondary">FOLLOWERS</div>
                  </div>
                  </div>
               <a href="https://unacademy.com/@ajaymishraakm382-9673" target="_blank" 
                  class="px-6 py-2 rounded-lg font-semibold bg-accent text-accent-text hover:opacity-90 transition w-full md:w-w-auto text-center inline-block">
               Follow
               </a>
            </div>
         </header>
         <nav class="mt-8">
            <div class="flex space-x-6 overflow-x-auto whitespace-nowrap border-b border-border">
               <a href="#" class="tab nav-tab py-3 text-sm font-semibold tab-active" data-tab="Free classes">FREE CLASSES </a>
               <a href="#" class="tab nav-tab py-3 text-sm font-semibold" data-tab="Courses">COURSES</a>
                <a href="#" class="tab nav-tab py-3 text-sm font-semibold " data-tab="module_pdf">MODULE PDF</a>

               <a href="#" class="tab nav-tab py-3 text-sm font-semibold" data-tab="modules">MODULE DISCUSSION</a>
               <a href="#" class="tab nav-tab py-3 text-sm font-semibold" data-tab="Quizzes">QUIZZES</a> <a href="#" class="tab nav-tab py-3 text-sm font-semibold " data-tab="PYQ Series">PYQ SERIES</a>
               <a href="#" class="tab nav-tab py-3 text-sm font-semibold hidden" data-tab="Module">Module</a>
               <a href="#" class="tab nav-tab py-3 text-sm font-semibold " data-tab="About">ABOUT</a>
            </div>
         </nav>
         <div id="filter-area" class="mt-6 flex space-x-4">
            <button id="filter-latest" class="filter-btn hidden" data-sort-order="desc">Latest</button>
            <button id="filter-oldest" class="filter-btn hidden" data-sort-order="asc">Oldest
            </button>
        </div>
       
         <div id="dynamic-content-area" class="mt-8">       </div>
      </div>
      
<div id="pdf-viewer-container" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; flex-direction:column;">
    <div class="pdf-toolbar" style="display:flex; justify-content:space-between; align-items:center; padding:15px 25px; background:#1a1a1a; color:white;">
        <div class="pdf-info flex items-center gap-3">
            <img src="/pictures/neelaxmi.png" style="height:30px;" alt="Logo">
            <span id="pdf-title-display" class="font-bold truncate max-w-[200px] md:max-w-md">PDF Viewer</span>
        </div>
        <div class="flex items-center gap-4">
            <button onclick="sharePdfLink()" title="Share Link" style="background:none; border:none; color:white; cursor:pointer;"><i class="fas fa-share-nodes"></i></button>
            <a id="download-btn" title="Download" style="color:white; text-decoration:none;" target="_blank"><i class="fas fa-download"></i></a>
            <button onclick="closePdf()" style="background:none; border:none; color:white; font-size:30px; cursor:pointer;">&times;</button>
        </div>
    </div>

    <div style="flex-grow:1; position:relative; display:flex; justify-content:center; background:#333; overflow:hidden;">
        <img src="/pictures/neelaxmi.png" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); opacity:0.1; width:300px; pointer-events:none; z-index:1;">
        
        <iframe id="pdf-frame" src="" style="width:100%; height:100%; border:none; position:relative; z-index:2; background:white;"></iframe>
    </div>
</div>

<script >
    
    
    /* -------------------------------------------------------------------------- */
/* CONFIGURATION                               */
/* -------------------------------------------------------------------------- */

const firebaseConfig = {
    apiKey: "AIzaSyDAZ_xwRd_uJcf-Gzv58HA9f_HZ7BCCJ8g",
    authDomain: "gallery-83144.firebaseapp.com",
    projectId: "gallery-83144",
    storageBucket: "gallery-83144.firebasestorage.app",
    messagingSenderId: "1005577519231",
    appId: "1:1005577519231:web:638899904126ae78cdff4a"
};

// Initialize Firebase
if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
}
const db = firebase.firestore();
const EDUCATOR_DOC_PATH = "educators/ajay_mishra";

const MAIN_THUMBNAIL_URL = "/pictures/akm.png";
const COMPANY_LOGO_URL = "/pictures/neelaxmi.png";

const body = document.body;
const themeSwitcher = document.getElementById('theme-switcher');
const contentArea = document.getElementById('dynamic-content-area');
const filterArea = document.getElementById('filter-area');

let currentActiveTab = 'free_classes';
let currentSortOrder = 'desc';

/* -------------------------------------------------------------------------- */
/* STATIC JSON DATA                             */
/* -------------------------------------------------------------------------- */

const modulesData = {
    "metadata": {
        "instructor": "AJAY SIR [AKM] SIR",
        "target_audience": "NEET UG & JEE MAIN Aspirants",
        "created_by": "Team SAKSEN",
        "credits": ["SAKSHAM"]
    },
    "courses": [
        {
            "title": "Mole Concept",
            "modules": [
                { "range": "From Q1 to Q15", "link": "https://unacademy.app.link/8TKTVArmhzb" },
                { "range": "From Q16 to Q41", "link": "https://unacademy.com/class/module-discussion-i/MF8WKVAX" },
                { "range": "From Q42 to Q61", "link": "https://unacademy.com/class/module-discussion-ii/HXBCEN9Z" },
                { "range": "From Q62 to Q71", "link": "https://unacademy.com/class/module-discussion/L3Z4HZ5B" },
                { "range": "From Q72 to Q90", "link": "https://unacademy.com/class/doubt-clearing-session/NHZHH8K4" },
                { "range": "From Q91 to Q103", "link": "https://unacademy.com/class/module-discussion-mole-concept-i/R0EWGXHR" },
                { "range": "From Q104 to Q118", "link": "https://unacademy.com/class/module-discussion-mole-concept-ii/4N9RRY5O" },
                { "range": "From Q119 to Last", "link": "https://unacademy.com/class/doubt-clearing-session/N18LZG5K" }
            ]
        },
        {
            "title": "Atomic Structure",
            "modules": [
                { "range": "From Q1 to Q11", "link": "https://unacademy.com/class/doubt-clearing-session/9O6OUBHK" },
                { "range": "From Q12 to Q30", "link": "https://unacademy.com/class/module-discussion-mole-concept/B34X537A" },
                { "range": "From Q31 to Q85", "link": "https://unacademy.com/course/module-discussion-jstar-series-2023/ASBJBNVP" },
                { "range": "From Q86 to Q180", "link": "https://unacademy.com/course/module-discussion-jstar-series-atomic-structure/K748UA4B" },
                { "range": "Part 1", "link": "https://unacademy.com/course/module-discussion-jstar-series-atomic-structure/K748UA4B" },
                { "range": "Part 2", "link": "https://unacademy.com/course/module-discussion-jstar-series-2023/ASBJBNVP" },
                { "range": "Part 3", "link": "https://unacademy.app.link/Ivu0D0k0grb" }
            ]
        },
        {
            "title": "Chemical Equilibrium",
            "modules": [
                { "range": "From Q1 to Q29", "link": "https://unacademy.com/class/module-discussion-iii/B8FOZN2Z" },
                { "range": "From Q30 to Last", "link": "https://unacademy.com/course/module-discussion-jstar-series/ITRNUJI3" }
            ]
        },
        {
            "title": "Thermodynamics",
            "modules": [
                { "range": "From Q1 to Q25", "link": "https://unacademy.com/class/module-discussion-part-iiii/N4Q060PD" },
                { "range": "From Q26 to Q158", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-thermodynamics/0H1L15TI" },
                { "range": "From Q159 to Last", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-thermodynamics/0H1L15TI" },
                { "range": "Part 1", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-solution-and-thermodynamics/PF9AQD9R" },
                { "range": "Part 2", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-thermodynamics-and-electrochemistry/YL579OPT" },
                { "range": "Part 3", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-thermodynamics/0H1L15TI" }
            ]
        },
        {
            "title": "Ionic Equilibrium",
            "modules": [
                { "range": "Open", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-ionic-equilibrium/6M45BE7C" }
            ]
        },
        {
            "title": "Redox Reactions",
            "modules": [
                { "range": "Not Yet Discussed", "link": "https://telegram.me/saksen_journey_offical" }
            ]
        },
        {
            "title": "Solutions",
            "modules": [
                { "range": "From Q1 to Q76", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-2022/TTZTV36O" },
                { "range": "From Q77 to Last", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-solution/R8ZBJVKP" },
                { "range": "PYQs", "link": "https://unacademy.com/class/module-discussion-part-i/7RNIFBZ3" },
                { "range": "Ques Last Lecture", "link": "https://unacademy.com/class/module-discussion-part-i/7RNIFBZ3" }
            ]
        },
        {
            "title": "Electrochemistry",
            "modules": [
                { "range": "Q1 to Q4 (01:13:13)", "link": "https://unacademy.com/class/module-discussion-part-iv/6L0FDZES" },
                { "range": "Q5 to Q23", "link": "https://unacademy.com/class/module-discussion-part-v/2AME24U3" },
                { "range": "Q24 to Q43", "link": "https://unacademy.com/class/module-discussion-part-vi/29AR28YQ" },
                { "range": "Q44 to Q59", "link": "https://unacademy.com/class/ionic-equilibrium-part-iv/RJPMGN5U" },
                { "range": "Q60 to Q70", "link": "https://unacademy.com/class/ionic-equilibrium-part-i/LEM21UEJ" },
                { "range": "Q71 to Q84", "link": "https://unacademy.com/class/ionic-equilibrium-part-ii/0FGRJ31L" },
                { "range": "Q85 to Q102", "link": "https://unacademy.com/class/doubt-clearing-session/FG4MD60A" },
                { "range": "Q103 to Q120 (Last Lecture 31st May)", "link": "https://unacademy.com/course/course-on-module-discussion-jstar-series-ionic-equilibrium/ZT34ZWGT" }
            ]
        },
        {
            "title": "Chemical Kinetics",
            "modules": [
                { "range": "Q1 to Q19", "link": "https://unacademy.com/class/module-discussion-chemical-kinetics-i/POQWVIQP" },
                { "range": "Q20 to Q45", "link": "https://unacademy.com/class/doubt-clearing-session/UKR5O2T9" },
                { "range": "Q46 to Q68", "link": "https://unacademy.com/class/module-discussion-chemical-kinetics-ii/BOMWCSDX" },
                { "range": "Q69 to Last", "link": "https://unacademy.com/class/module-discussion-solution/W6FOWOZD" },
                { "range": "OUR MAIN CHANNEL", "link": "https://t.me/saksen_journey_offical" }
            ]
        }
    ],
    "pyq_series": [
        {
            "title": "Mole Concept - PYQ",
            "modules": [
                { "range": "PYQ Discussion 1", "link": "https://unacademy.com/class/pyq-jstar-series-chemical-kinetics/BYGE8X4U" },
                { "range": "PYQ Discussion 2", "link": "https://unacademy.com/class/pyq-jstar-series-mole-concept/Y9QCER4B" },
                { "range": "PYQ Course Link", "link": "https://unacademy.com/course/pyq-jstar-series-mole-concept/FPRU1RH3" }
            ]
        },
        {
            "title": "Atomic Structure - PYQ",
            "modules": [
                { "range": "PYQ Discussion", "link": "https://unacademy.com/class/pyq-jstar-series-atomic-structure/11267ZWJ" }
            ]
        },
        {
            "title": "Chemical Equilibrium - PYQ",
            "modules": [
                { "range": "PYQ Discussion 1", "link": "https://unacademy.com/class/pyq-jstar-series-chemical-equilibrium/OTBTTJYW" },
                { "range": "PYQ Discussion 2", "link": "https://unacademy.com/class/pyq-jstar-series-chemical-equilibrium/PH00C0DO" },
                { "range": "PYQ Discussion 3", "link": "https://unacademy.com/class/pyq-jstar-series-chemical-equilibrium-776/C2F1B49" },
                { "range": "PYQ Series I", "link": "https://unacademy.com/class/pyqs-jstar-series-chemical-equilibrium-i/B6BTWUK5" },
                { "range": "PYQ Series II", "link": "https://unacademy.com/class/pyqs-jstar-series-chemical-equilibrium-ii/LIQKXA37" }
            ]
        },
        {
            "title": "Thermodynamics - PYQ",
            "modules": [
                { "range": "PYQ Discussion 1", "link": "https://unacademy.app.link/DAhscD15Mtb" },
                { "range": "Module/PYQ Part I", "link": "https://unacademy.com/class/module-discussion-part-i/7RNIFBZ3" },
                { "range": "Module/PYQ Part II", "link": "https://unacademy.com/class/module-discussion-part-ii/ESQ2Z46Z" }
            ]
        },
        {
            "title": "Ionic Equilibrium - PYQ",
            "modules": [
                { "range": "PYQ Discussion I", "link": "https://unacademy.com/class/pyq-jstar-series-ionic-equilibrium-200/6VOCNHDQ" },
                { "range": "PYQ Discussion II", "link": "https://unacademy.com/class/pyq-jstar-series-ionic-equilibrium-ii/WUU84NMS" },
                { "range": "PYQ Course Link", "link": "https://unacademy.com/course/pyq-jstar-series-solution/U0L2ZRT5" }
            ]
        },
        {
            "title": "Redox Reactions - PYQ",
            "modules": [
                { "range": "PYQ Discussion", "link": "https://unacademy.com/class/pyq-jstar-series-redox-reaction-453/1F8EKTSE" }
            ]
        },
        {
            "title": "Solutions - PYQ",
            "modules": [
                { "range": "PYQ Discussion 1", "link": "https://unacademy.com/class/pyq-jstar-series-solutions/EANC670M" },
                { "range": "PYQ Discussion 2", "link": "https://unacademy.com/class/pyq-jstar-series-solutions-847/2EA5JXAE" },
                { "range": "PYQ Discussion 3", "link": "https://unacademy.com/class/pyq-jstar-series-solutions/SFRKFMRO" },
                { "range": "PYQ Series 4", "link": "https://unacademy.com/class/pyqs-jstar-series-solutions/ALW4DGEN" },
                { "range": "PYQ Discussion 5", "link": "https://unacademy.com/class/pyq-jstar-series-solution/W3LG7VUE" },
                { "range": "PYQ Solid State (Related)", "link": "https://unacademy.com/class/pyq-jstar-series-solid-state/HUYH0G3R" },
                { "range": "PYQ Discussion 6", "link": "https://unacademy.com/class/pyq-jstar-series-solutions/YTOUM8D7" }
            ]
        },
        {
            "title": "Electrochemistry - PYQ",
            "modules": [
                { "range": "PYQ Course I", "link": "https://unacademy.com/course/pyq-jstar-series-electrochemistry/SNRJFGA8" },
                { "range": "PYQ Course II", "link": "https://unacademy.com/course/pyq-jstar-series-electrochemistry-ii/IKKXIIPI" }
            ]
        },
        {
            "title": "Chemical Kinetics - PYQ",
            "modules": [
                { "range": "PYQ Discussion 1", "link": "https://unacademy.com/class/pyq-jstar-series-chemical-kinetics/BYGE8X4U" },
                { "range": "PYQ Series 2", "link": "https://unacademy.com/class/pyqs-jstar-series-chemical-kinetics/CHUCOY49" },
                { "range": "PYQ Discussion 3", "link": "https://unacademy.com/class/pyq-jstar-series-chemical-kinetics/F3L0KEHW" },
                { "range": "PYQ Series 4", "link": "https://unacademy.com/class/pyqs-jstar-series-chemical-kinetics/ZGB5YVJN" }
            ]
        }
    ],
    "social_links": [
        { "title": "JOIN US", "url": "https://telegram.me/saksen_journey_offical" },
        { "title": "AJAY SIR sir other material", "url": "https://telegram.me/pj_sir_dpp_module" }
    ]
};

/* -------------------------------------------------------------------------- */
/* UTILITY FUNCTIONS                           */
/* -------------------------------------------------------------------------- */

function formatStat(num) {
    if (num === null || num === undefined) return '0';
    if (num >= 1000000) return (num / 1000000).toFixed(0) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
    return num;
};

function formatViewCount(num) {
    if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
    return num;
}

function fetchAndRenderStats() {
    document.getElementById('watchMinsDisplay').textContent = '...';
    document.getElementById('dedicationsDisplay').textContent = '...';
    document.getElementById('followersDisplay').textContent = '...';

    db.doc(EDUCATOR_DOC_PATH).get()
        .then((doc) => {
            if (doc.exists) {
                const data = doc.data();
                document.getElementById('watchMinsDisplay').textContent = formatStat(data.watchmin);
                document.getElementById('dedicationsDisplay').textContent = formatStat(data.dedications);
                document.getElementById('followersDisplay').textContent = formatStat(data.followers);
            } else {
                console.log("No such document for stats!");
            }
        })
        .catch((error) => {
            console.error("Error fetching document: ", error);
        });
}

/* -------------------------------------------------------------------------- */
/* RENDER FUNCTIONS                             */
/* -------------------------------------------------------------------------- */

let currentTabContent = {}; // Cache

async function fetchAndRenderContent(collectionName, sortOrder = 'desc') {
    contentArea.innerHTML = `<div class="p-8 text-center text-secondary">Loading ${collectionName}...</div>`;
    currentSortOrder = sortOrder;

    try {
        const snapshot = await db.doc(EDUCATOR_DOC_PATH).collection(collectionName)
            .where('status', '==', 'approved')
            .orderBy('createdAt', sortOrder)
            .get();

        let contentArray = [];
        snapshot.forEach(doc => {
            const data = doc.data();
            data.timeText = data.createdAt ? data.createdAt.toDate().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }) : 'Date N/A';
            contentArray.push(data);
        });

        currentTabContent[collectionName] = contentArray;

        if (collectionName === 'free_classes') {
            renderFreeClassCards(contentArray);
        } else if (collectionName === 'courses') {
            renderCourseCards(contentArray);
        }
    } catch (error) {
        console.error("Error fetching content:", error);
        contentArea.innerHTML = `<div class="p-8 text-center text-red-500">Error loading content: ${error.message}</div>`;
    }
    updateFilterButtonStyling(sortOrder);
}

function renderFreeClassCards(contentArray) {
    if (contentArray.length === 0) {
        contentArea.innerHTML = `<div class="p-8 text-center text-secondary">No free classes found.</div>`;
        return;
    }

    const cardsHtml = contentArray.map(item => {
        const thumb = MAIN_THUMBNAIL_URL;
        const logo = COMPANY_LOGO_URL;
        const dateDisplay = item.timeText || 'Date N/A';

        return `
            <a href="${item.link}" target="_blank" class="card block bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-xl transition-all duration-300 group h-full flex flex-col">
                <div class="relative w-full h-44 overflow-hidden">
                    <img src="${thumb}" alt="${item.title}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500">
                    <div class="absolute bottom-3 left-3 w-10 h-10 rounded-full border-2 border-white overflow-hidden shadow-md">
                        <img src="${logo}" class="w-full h-full object-cover">
                    </div>
                    ${item.viewsCount ? `<div class="absolute top-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded backdrop-blur-sm flex items-center"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>${formatViewCount(item.viewsCount)}</div>` : ''}
                </div>
                <div class="p-4 flex flex-col flex-grow">
                    <div class="flex items-center mb-2">
                        <span class="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded border border-blue-100 uppercase tracking-wide">
                            ${item.subject || 'Physics'}
                        </span>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 leading-snug mb-3 group-hover:text-blue-600 transition-colors">
                        ${item.title}
                    </h3>
                    <div class="flex items-center gap-3 mb-4 text-sm">
                        <div class="flex items-center text-gray-600 bg-gray-100 px-2 py-1 rounded">
                            <span class="font-medium">Starts: ${dateDisplay}</span>
                        </div>
                    </div>
                    <div class="relative bg-gray-50 rounded-lg p-3 mb-4 border border-gray-100">
                        <p class="text-sm text-gray-600 leading-relaxed">
                            ${item.description || 'No description provided.'}
                        </p>
                    </div>
                    <div class="mt-auto pt-3 border-t border-gray-100 flex items-center justify-between">
                        <span class="text-xs text-gray-400 font-medium">${item.language || 'Hindi'}</span>
                        <span class="text-sm font-semibold text-blue-600 flex items-center">
                            Watch Now 
                            <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                        </span>
                    </div>
                </div>
            </a>
        `;
    }).join('');

    contentArea.innerHTML = `<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">${cardsHtml}</div>`;
}

function renderCourseCards(courseArray) {
    if (courseArray.length === 0) {
        contentArea.innerHTML = `<div class="p-8 text-center text-secondary">No courses found.</div>`;
        return;
    }

    const cardsHtml = courseArray.map(course => {
        const thumb = MAIN_THUMBNAIL_URL;
        const dateDisplay = course.timeText || 'Date N/A';

        return `
            <a href="${course.link}" target="_blank" class="card block bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-xl transition-all duration-300 group h-full flex flex-col">
                <div class="relative w-full h-44 overflow-hidden">
                    <img src="${thumb}" alt="${course.name}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60"></div>
                    <div class="absolute bottom-3 left-4 text-white font-bold flex items-center">
                         Full Course
                    </div>
                </div>
                <div class="p-5 flex flex-col flex-grow">
                    <h3 class="text-xl font-bold text-gray-900 mb-3 group-hover:text-blue-600 transition-colors">${course.name}</h3>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <span class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-green-100 text-green-800">
                            Start: ${dateDisplay}
                        </span>
                        <span class="inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-purple-100 text-purple-800">
                            ${course.duration || 'N/A Duration'}
                        </span>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-100 mb-4">
                        <p class="text-sm text-gray-600 leading-relaxed">
                            <span class="font-bold text-gray-800">Summary:</span> ${course.description || 'No description available.'}
                        </p>
                    </div>
                    <div class="mt-auto">
                        <button class="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors shadow-md flex justify-center items-center">
                            View Course
                        </button>
                    </div>
                </div>
            </a>
        `;
    }).join('');

    contentArea.innerHTML = `<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">${cardsHtml}</div>`;
}

function renderModulesGridFromJSON() {
    const courses = modulesData.courses;

    if (courses.length === 0) {
        contentArea.innerHTML = `<div class="p-8 text-center text-gray-500">üòî No module data found in JSON.</div>`;
        return;
    }

    const headerHtml = `
        <div class="mb-10 border-l-4 border-indigo-500 pl-6">
            <h2 class="text-3xl font-extrabold text-gray-800 tracking-tight">üìö Topic-wise Module Discussion Links</h2>
            <p class="text-md text-gray-500 mt-1">Detailed discussions by question range, organized by subject.</p>
        </div>
    `;

    const cardsHtml = courses.map(course => `
        <div class="module-card relative card bg-white rounded-2xl p-6 shadow-xl overflow-hidden transform hover:scale-[1.02] hover:shadow-2xl transition-all duration-500 ring-1 ring-gray-100 group">
            <div class="absolute inset-0 opacity-10 bg-gradient-to-br from-indigo-50 to-white"></div>
            <span class="absolute top-0 right-0 bg-indigo-500 text-white text-xs font-bold px-3 py-1 rounded-bl-xl tracking-wider status">
                ${course.status || 'Active'} 
            </span>
            <div class="relative z-10">
                <div class="mb-4 p-2 inline-block rounded-full bg-indigo-100 text-indigo-600 shadow-lg">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.46 9.248 5 7.5 5S4.168 5.46 3 6.253v13C4.168 18.46 5.752 18 7.5 18s3.332.46 4.5 1.253m0-13C13.168 5.46 14.752 5 16.5 5s3.332.46 4.5 1.253v13C19.832 18.46 18.248 18 16.5 18s-3.332.46-4.5 1.253"></path>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-5 leading-snug border-b pb-3 border-gray-100">${course.title}</h3>
            </div>
            <ul class="space-y-4 relative z-10">
                ${course.modules.map(module => `
                    <li class="flex justify-between items-center text-sm border-b border-gray-100 last:border-b-0 pb-3">
                        <span class="font-medium text-gray-700">${module.range}</span>
                        <a href="${module.link}" target="_blank"
                            class="text-xs bg-indigo-500 text-white py-1 px-3 rounded-full hover:bg-indigo-600 transition-colors shadow-md flex items-center group-hover:shadow-lg">
                            Watch Now
                        </a>
                    </li>
                `).join('')}
            </ul>
        </div>
    `).join('');

    contentArea.innerHTML = `<div class="animate-fade-in p-4 sm:p-0">${headerHtml}<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">${cardsHtml}</div></div>`;
}

async function loadQuizCards() {
    toggleFilterButtons(false);
    contentArea.innerHTML = `<div class="p-8 text-center text-secondary">Loading Quizzes from Firebase...</div>`;
    const companyLogo = COMPANY_LOGO_URL;

    try {
        const snapshot = await db.doc(EDUCATOR_DOC_PATH).collection('quizzes').get();
        let quizzesArray = [];
        snapshot.forEach(doc => {
            const data = doc.data();
            quizzesArray.push({
                id: doc.id,
                targetQuizId: data.targetQuizId,
                ...data
            });
        });

        if (quizzesArray.length === 0) {
            contentArea.innerHTML = `<div class="p-8 text-center text-gray-500">üòî No quizzes found on Firebase.</div>`;
            return;
        }

        const cardsHtml = quizzesArray.map(quiz => {
            const activeQuizID = quiz.targetQuizId ? quiz.targetQuizId : quiz.id;
            const title = quiz.title || 'Untitled Quiz';
            const subject = quiz.subject || 'General';
            const questions = quiz.questions || 'N/A';
            const duration = quiz.duration || 'N/A';
            const thumbnailHtml = companyLogo ? `<img src="${companyLogo}" alt="Company Logo" class="w-10 h-10 rounded-full object-cover border border-border flex-shrink-0">` : '';

            return `
                <div class="card p-6 rounded-xl transform hover:scale-[1.02] transition duration-300 h-full flex flex-col justify-between">
                    <div class="flex justify-between items-start mb-4">
                        <span class="text-xs font-bold text-accent bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full border border-border uppercase tracking-wide inline-block">
                            ${subject}
                        </span>
                        ${thumbnailHtml}
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-primary mb-5 leading-snug">
                            ${title}
                        </h3>
                    </div>
                    <div class="space-y-3 mb-6">
                        <div class="flex items-center text-sm text-secondary">
                             <span class="font-semibold text-primary mr-1">${questions}</span> Questions
                        </div>
                        <div class="flex items-center text-sm text-secondary">
                             <span class="font-semibold text-primary mr-1">${duration}</span> Mins
                        </div>
                    </div>
                    <a href="/quiz/quizzes.html?uid=${activeQuizID}" 
                       class="w-full text-center py-3 border border-transparent text-sm font-semibold rounded-lg text-accent-text bg-accent hover:opacity-90 transition-colors flex items-center justify-center shadow-md">
                        Attempt Quiz <span class="ml-2">üöÄ</span>
                    </a>
                </div>
            `;
        }).join('');

        contentArea.innerHTML = `
            <div class="mb-10 border-l-4 border-accent pl-6">
                <h2 class="text-3xl font-extrabold text-primary tracking-tight">üéØ Available Quizzes & Assessments</h2>
                <p class="text-md text-secondary mt-1">Clicking a quiz will open it in a new tab.</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">${cardsHtml}</div>
        `;

    } catch (error) {
        console.error("Error fetching quizzes:", error);
        contentArea.innerHTML = `<div class="p-8 text-center text-red-500">Error loading quizzes from Firebase: ${error.message}</div>`;
    }
}

function renderPYQGridFromJSON() {
    toggleFilterButtons(false);
    const courses = modulesData.pyq_series || [];

    if (courses.length === 0) {
        contentArea.innerHTML = `<div class="p-8 text-center text-gray-500">üòî No PYQ data found in JSON.</div>`;
        return;
    }

    const headerHtml = `
        <div class="mb-10 border-l-4 border-red-500 pl-6">
            <h2 class="text-3xl font-extrabold text-gray-800 tracking-tight">üèÜ Previous Year Questions (PYQ) Series Links</h2>
        </div>
    `;

    const cardsHtml = courses.map(course => `
        <div class="module-card relative card bg-white rounded-2xl p-6 shadow-xl overflow-hidden transform hover:scale-[1.02] hover:shadow-2xl transition-all duration-500 ring-1 ring-gray-100 group">
            <div class="absolute inset-0 opacity-10 bg-gradient-to-br from-red-50 to-white"></div>
            <span class="absolute top-0 right-0 bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-bl-xl tracking-wider status">PYQ</span>
            <div class="relative z-10">
                <div class="mb-4 p-2 inline-block rounded-full bg-red-100 shadow-lg overflow-hidden">
                    <img src="/pictures/neelaxmi.png" alt="Company Logo" class="w-20 h-20 object-cover rounded-full">
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-5 leading-snug border-b pb-3 border-gray-100">${course.title}</h3>
            </div>
            <ul class="space-y-4 relative z-10">
                ${course.modules.map(module => `
                    <li class="flex justify-between items-center text-sm border-b border-gray-100 last:border-b-0 pb-3">
                        <span class="font-medium text-gray-700">${module.range}</span>
                        <a href="${module.link}" target="_blank"
                            class="text-xs bg-red-500 text-white py-1 px-3 rounded-full hover:bg-red-600 transition-colors shadow-md flex items-center group-hover:shadow-lg">
                            Watch Now
                        </a>
                    </li>
                `).join('')}
            </ul>
        </div>
    `).join('');

    contentArea.innerHTML = `<div class="animate-fade-in p-4 sm:p-0">${headerHtml}<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">${cardsHtml}</div></div>`;
}

function renderAboutSection() {
    toggleFilterButtons(false);
    const akmData = {
        name: "Ajay Kumar Mishra",
        shortName: "AKM Sir",
        title: "No.1 Physical Chemistry Educator",
        experience: "10+ Years",
        birthday: "12th December",
        institutes: ["Unacademy (Current)", "Ex-Allen (Kota)", "Ex-Sarvottam (Kota)"],
        nicknames: ["Chachu", "Jahar Chachu"],
        vibes: ["Deep Lines", "Singer", "Shayari Master", "Meme Reviewer"],
        tagline: "Gussa kam hai, par Concept Jahar hai!",
        links: {
            instagram: "https://www.instagram.com/ajay.mishra.56481379/?hl=en",
            unacademy: "https://unacademy.com/@ajaymishraakm382-9673"
        }
    };

    const content = `
    <div class="animate-fade-in max-w-6xl mx-auto pb-10">
        <div class="cyber-grid mb-8">
            <div class="cyber-card col-span-12 md:col-span-8 flex flex-col md:flex-row items-center gap-8 relative overflow-hidden group">
                <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                    <svg class="w-64 h-64 text-blue-600" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L1 21h22L12 2zm0 3.99L19.53 19H4.47L12 5.99z"/></svg>
                </div>
                <div class="w-40 h-40 md:w-48 md:h-48 rounded-full p-1 bg-gradient-to-tr from-blue-500 to-purple-600 neon-badge flex-shrink-0">
                    <img src="/pictures/akmsir.jpg" onerror="this.src='https://placehold.co/200x200?text=AKM'" class="w-full h-full object-cover rounded-full border-4 border-white dark:border-gray-800">
                </div>
                <div class="text-center md:text-left z-10">
                    <h2 class="text-4xl md:text-5xl font-black text-gradient mb-2">${akmData.name}</h2>
                    <p class="text-xl text-secondary font-medium mb-4 tracking-wide">[ ${akmData.shortName} ]</p>
                    <div class="flex flex-wrap justify-center md:justify-start gap-2">
                        <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-bold uppercase tracking-wider">NEET UG Specialist</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-bold uppercase tracking-wider">Physical Chemistry</span>
                    </div>
                </div>
            </div>
            <div class="cyber-card col-span-12 md:col-span-4 flex flex-col justify-center items-center text-center bg-gradient-to-br from-blue-600 to-indigo-700 text-white border-none shadow-lg shadow-blue-500/30">
                <h3 class="text-6xl font-black mb-1">${akmData.experience}</h3>
                <p class="text-blue-100 text-sm font-semibold tracking-widest uppercase">Teaching Excellence</p>
                <div class="mt-4 text-xs text-blue-200">${akmData.institutes.join(" ‚Ä¢ ")}</div>
            </div>
        </div>
        <div class="cyber-grid mb-8">
            <div class="cyber-card col-span-12 md:col-span-4">
                <div class="flex items-center gap-3 mb-4"><span class="text-2xl">üòé</span><h3 class="text-xl font-bold text-primary">The "Chachu" Vibe</h3></div>
                <p class="text-secondary text-sm leading-relaxed mb-4">Known lovingly as <strong>"${akmData.nicknames.join('" & "')}"</strong>.</p>
                <div class="flex flex-wrap gap-2">${akmData.vibes.map(vibe => `<span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-xs text-secondary border border-border">${vibe}</span>`).join('')}</div>
            </div>
            <div class="cyber-card col-span-12 md:col-span-4 j-star-bg border-none relative overflow-hidden group">
                <h3 class="text-2xl font-black text-yellow-400 mb-2 italic">J* Series</h3>
                <p class="text-gray-300 text-sm mb-4">"Jahar" questions designed to build advanced conceptual clarity.</p>
            </div>
             <div class="cyber-card col-span-12 md:col-span-4 flex flex-col justify-between">
                <div><h3 class="text-sm font-bold text-secondary uppercase tracking-widest mb-2">Birthday</h3><div class="flex items-center gap-3"><span class="text-3xl">üéÇ</span><span class="text-2xl font-bold text-primary">${akmData.birthday}</span></div></div>
                <div class="mt-6 pt-4 border-t border-border"><h3 class="text-sm font-bold text-secondary uppercase tracking-widest mb-2">Famous For</h3><p class="italic text-primary">"${akmData.tagline}"</p></div>
            </div>
        </div>
        <div class="cyber-card p-0 overflow-hidden bg-gradient-to-r from-gray-900 to-gray-800 text-white">
            <div class="p-6 md:p-8 flex flex-col md:flex-row justify-between items-center gap-6">
                <div><h3 class="text-2xl font-bold mb-1">Connect with AKM Sir</h3></div>
                <div class="flex gap-4">
                    <a href="${akmData.links.instagram}" target="_blank" class="px-6 py-3 rounded-full bg-gradient-to-r from-pink-500 to-yellow-500 font-bold">Instagram</a>
                    <a href="${akmData.links.unacademy}" target="_blank" class="px-6 py-3 rounded-full bg-blue-600 font-bold">Unacademy</a>
                </div>
            </div>
        </div>
    </div>`;
    contentArea.innerHTML = content;
}

function renderLegacyContent(tabName) {
    toggleFilterButtons(false);
    const contentMap = {
        'Module': {
            title: "Main Module Repository",
            text: "This repository hosts the comprehensive, downloadable study MODULE DISCUSSION (PDFs, notes, and handouts).",
            link: { href: modulesData.social_links.find(l => l.title === 'AJAY SIR sir other material')?.url || '#', text: "Access Module Repository" }
        }
    };
    const data = contentMap[tabName];
    if (!data) return '';
    return `
        <div class="max-w-4xl mx-auto">
            <a href="${data.link.href}" target="_blank" class="cyber-card flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-6 hover:shadow-xl transition-all cursor-pointer group">
                <div class="flex-grow">
                    <h3 class="text-2xl font-bold text-primary mb-2">${data.title}</h3>
                    <p class="text-secondary mb-4">${data.text}</p>
                    <span class="text-accent font-semibold flex items-center group-hover:underline">${data.link.text}</span>
                </div>
            </a>
        </div>
    `;
}

/* -------------------------------------------------------------------------- */
/* NEW PDF VIEWER LOGIC                                */
/* -------------------------------------------------------------------------- */

function injectPdfViewer() {
    if (!document.getElementById('pdf-viewer-container')) {
        const viewerHTML = `
            <div id="pdf-viewer-container" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; flex-direction:column; align-items:center; justify-content:center;">
                <button onclick="closePdf()" style="position:absolute; top:20px; right:30px; color:white; font-size:40px; background:none; border:none; cursor:pointer;">&times;</button>
                <iframe id="pdf-frame" src="" style="width:90%; height:90%; border:none; border-radius:8px; background:white;"></iframe>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', viewerHTML);
    }
}

let currentPdfUrl = '';
let currentPdfTitle = '';

function openPdf(link, title = 'Module PDF') {
    currentPdfUrl = link;
    currentPdfTitle = title;
    
    let displayLink = link;
    // Force Google Drive links into Preview Mode to avoid "Invalid Structure" errors
    if (link.includes('drive.google.com')) {
        displayLink = link.replace(/\/view.*/, '/preview').replace(/\/edit.*/, '/preview');
    }

    const container = document.getElementById('pdf-viewer-container');
    const frame = document.getElementById('pdf-frame');
    const titleText = document.getElementById('pdf-title-display');
    const dlBtn = document.getElementById('download-btn');

    if(container && frame) {
        titleText.innerText = title;
        dlBtn.href = link; 
        frame.src = displayLink;
        container.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
}

function closePdf() {
    const container = document.getElementById('pdf-viewer-container');
    const frame = document.getElementById('pdf-frame');
    if(container && frame) {
        frame.src = ''; 
        container.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

function sharePdfLink() {
    if (!currentPdfTitle) return;

    // Convert "Mole Concept Part 1" to "mole-concept-part-1"
    const slug = currentPdfTitle
        .toLowerCase()
        .trim()
        .replace(/[^\w\s-]/g, '')
        .replace(/[\s_-]+/g, '-')
        .replace(/^-+|-+$/g, '');

    const baseUrl = window.location.origin + window.location.pathname;
    const shareUrl = `${baseUrl}?module=${slug}`; // NO MORE DATA PARAMETER!

    navigator.clipboard.writeText(shareUrl).then(() => {
        alert("Clean link copied: " + slug);
    });
}
//-------------------------------------------------------------------------- */
//* DYNAMIC PDF FETCHING                        */
//* -------------------------------------------------------------------------- */

async function fetchAndRenderModulePdfs() {
    toggleFilterButtons(false);
    contentArea.innerHTML = `<div class="p-8 text-center text-secondary">Loading Modules...</div>`;
    
    try {
        const snapshot = await db.doc(EDUCATOR_DOC_PATH).collection('module_pdfs')
            .where('status', '==', 'approved')
            .orderBy('createdAt', 'desc')
            .get();

        let pdfArray = [];
        snapshot.forEach(doc => {
            pdfArray.push(doc.data());
        });

        if (pdfArray.length === 0) {
            contentArea.innerHTML = `<div class="p-8 text-center text-secondary">No PDF modules found in database.</div>`;
            return;
        }

        const cardsHtml = pdfArray.map(item => {
            return `
                <div onclick="openPdf('${item.link}', '${item.title.replace(/'/g, "\\'")}')" class="card cursor-pointer block bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-xl transition-all duration-300 group h-full flex flex-col relative">
                    <div class="relative w-full h-44 overflow-hidden">
                        <img src="${MAIN_THUMBNAIL_URL}" alt="Class Thumbnail" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500">
                        <div class="absolute bottom-3 left-3 w-10 h-10 rounded-full border-2 border-white overflow-hidden shadow-md z-10">
                            <img src="${COMPANY_LOGO_URL}" class="w-full h-full object-cover">
                        </div>
                        <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors"></div>
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                             <div class="bg-white/90 rounded-full p-3 shadow-lg">
                                <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                             </div>
                        </div>
                    </div>
                    <div class="p-4 flex flex-col flex-grow">
                         <div class="flex items-center mb-2">
                             <span class="text-xs font-bold text-red-600 bg-red-50 px-2 py-0.5 rounded border border-red-100 uppercase tracking-wide">
                                 ${item.subject || 'PDF Module'}
                             </span>
                         </div>
                         <h3 class="text-lg font-bold text-primary leading-snug mb-1 group-hover:text-accent transition-colors">
                             ${item.title}
                         </h3>
                         <p class="text-xs text-secondary mt-auto pt-2 flex items-center">
                            <span class="w-2 h-2 rounded-full bg-green-500 mr-2"></span> Click to Open PDF
                         </p>
                    </div>
                </div>
            `;
        }).join('');

        contentArea.innerHTML = `
            <div class="mb-6 border-l-4 border-red-500 pl-4">
                 <h2 class="text-2xl font-bold text-primary">üìÑ Module PDFs</h2>
                 <p class="text-sm text-secondary">Fetched dynamically from Firebase. Click to read.</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">${cardsHtml}</div>
        `;
        
        injectPdfViewer();

    } catch (error) {
        console.error("Error fetching PDFs:", error);
        contentArea.innerHTML = `<div class="p-8 text-center text-red-500">Error loading PDFs: ${error.message}</div>`;
    }
}

/* -------------------------------------------------------------------------- */
/* CORE LOGIC & INIT                             */
/* -------------------------------------------------------------------------- */

function toggleFilterButtons(show) {
    filterArea.style.display = show ? 'flex' : 'none';
}

function updateFilterButtonStyling(activeOrder) {
    document.querySelectorAll('.filter-btn').forEach(btn => {
        if (btn.dataset.sortOrder === activeOrder) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });
}

function handleFilterClick(event) {
    const button = event.currentTarget;
    const newSortOrder = button.dataset.sortOrder;
    if (newSortOrder === currentSortOrder) return;
    loadTabContent(currentActiveTab, newSortOrder);
}

// Map tab names to render functions
const tabContentRenderers = {
    'Free classes': (sortOrder = 'desc') => { toggleFilterButtons(true); fetchAndRenderContent('free_classes', sortOrder); },
    'Courses': (sortOrder = 'desc') => { toggleFilterButtons(true); fetchAndRenderContent('courses', sortOrder); },
    'About': () => renderAboutSection(),
    'modules': () => { toggleFilterButtons(false); renderModulesGridFromJSON(); },
    'PYQ Series': () => renderPYQGridFromJSON(),
    'Quizzes': () => loadQuizCards(),
    'module_pdf': () => fetchAndRenderModulePdfs(),  
    'Module': () => contentArea.innerHTML = renderLegacyContent('Module'),
};

function loadTabContent(tabName, sortOrder = currentSortOrder) {
    currentActiveTab = tabName;
    currentSortOrder = sortOrder;

    document.querySelectorAll('.nav-tab').forEach(tab => {
        if (tab.getAttribute('data-tab') === tabName) {
            tab.classList.add('tab-active');
        } else {
            tab.classList.remove('tab-active');
        }
    });

    if (tabName === 'Free classes' || tabName === 'Courses') {
        tabContentRenderers[tabName](sortOrder);
    } else if (tabContentRenderers[tabName]) {
        toggleFilterButtons(false);
        tabContentRenderers[tabName]();
    } else {
        contentArea.innerHTML = `<div class="p-8 text-center text-red-500">Content not available for ${tabName}.</div>`;
    }
}

const THEME_KEY = 'pj_profile_theme';
const themes = [
    { id: 'default-ui', name: 'Default', icon: '‚òÄÔ∏è' },
    { id: 'dark', name: 'Dark', icon: 'üåô' },
    { id: 'vibrant', name: 'Vibrant', icon: 'üü¢' },
    { id: 'minimalist', name: 'Minimalist', icon: '‚ö™' },
    { id: 'unacademy-inspired', name: 'Unacademy', icon: '‚ö´' },
];

function switchTheme(themeId) {
    body.setAttribute('data-theme', themeId);
    localStorage.setItem(THEME_KEY, themeId);
    updateThemeButtons(themeId);
}

function renderThemeButtons(currentTheme) {
    themeSwitcher.innerHTML = themes.map(theme => `
        <button class="theme-btn ${theme.id === currentTheme ? 'active' : ''}" data-theme-id="${theme.id}" >
            ${theme.icon} ${theme.name}
        </button>
    `).join('');
}

function updateThemeButtons(activeTheme) {
    document.querySelectorAll('.theme-btn').forEach(btn => {
        if (btn.dataset.themeId === activeTheme) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });
}

document.addEventListener('DOMContentLoaded', async () => {
    const savedTheme = localStorage.getItem(THEME_KEY) || 'default-ui';
    renderThemeButtons(savedTheme);
    body.setAttribute('data-theme', savedTheme);
    const params = new URLSearchParams(window.location.search);
    const moduleSlug = params.get('module');    // Inject viewer initially
    injectPdfViewer();

    const navTabs = document.querySelectorAll('.nav-tab');
    navTabs.forEach(tab => {
        tab.addEventListener('click', (e) => {
            e.preventDefault();
            const tabName = e.currentTarget.getAttribute('data-tab');
            loadTabContent(tabName, 'desc');
        });
    });

    themeSwitcher.addEventListener('click', (e) => {
        const themeButton = e.target.closest('.theme-btn');
        if (themeButton && themeButton.dataset.themeId) {
            switchTheme(themeButton.dataset.themeId);
        }
    });
    
if (moduleSlug) {
        try {
            // Search Firebase for the module with this title
            const snapshot = await db.doc(EDUCATOR_DOC_PATH)
                .collection('module_pdfs')
                .where('status', '==', 'approved')
                .get();

            let foundFile = null;

            snapshot.forEach(doc => {
                const data = doc.data();
                // Create a slug from the database title to compare
                const dbSlug = data.title.toLowerCase().trim().replace(/[^\w\s-]/g, '').replace(/[\s_-]+/g, '-');
                
                if (dbSlug === moduleSlug) {
                    foundFile = data;
                }
            });

            if (foundFile) {
                openPdf(foundFile.link, foundFile.title);
            } else {
                console.log("Module not found in database.");
            }
            
            
            // Cleanup the URL bar to keep it pretty
            const cleanURL = window.location.origin + window.location.pathname;
            window.history.replaceState({}, '', cleanURL);

        } catch (error) {
            console.error("Error finding shared module:", error);
        }
    }
                
                
                
                
    document.getElementById('filter-latest').addEventListener('click', handleFilterClick);
    document.getElementById('filter-oldest').addEventListener('click', handleFilterClick);

    fetchAndRenderStats();
    loadTabContent('Free classes', 'desc');
    
    
});

    
    
</script>     

<script src="/history.js"></script>
   </body>
</html>